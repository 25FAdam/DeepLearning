# xView Satellite Imagery Classification

(Deep Learning course - Project) 

<ins>Authors:</ins>
- Ádám Földvári
- Máté Lukács
- Joseph Tartivel

<ins>Instructor:</ins> Roberto Valle

This repository contains the final project for the Deep Learning course at the Universidad Politécnica de Madrid (Master in Digital Innovation - EIT Digital). The task was to classify objects in satellite images using various deep learning techniques, starting from a basic feedforward neural network and progressing through regularization, convolutional networks, and transfer learning.

## Dataset

**Source:** [xView Dataset](https://xviewdataset.org/)
- **Type:** High-resolution satellite images (0.3m GSD, WorldView-3)
- **Split:** 761 training images, 85 testing images
- **Processed:** 21,377 training objects, 2,635 testing objects, cropped and resized to 224x224
- **Classes:** 12 (e.g., building, small car, cargo plane, helicopter, etc.)

## Evaluation Platform

Testing and final evaluation were conducted via [Codabench](https://www.codabench.org/), where we joined a private competition set up by the course instructor. Submissions were made in the required JSON format, and results were benchmarked against the private test set on the platform.

## 📁 Project Structure
```
.
├── app.py                    # Spark application to load and test the model
├── best_model                # Stored trained ML model (generated by notebook)
├── project.ipynb             # Jupyter notebook: data prep, training, validation
├── Data/                     # Folder containing CSV files
│   ├── 1991.csv              # 1991 training data
│   └── test_data.csv         # 1989 test data
└── README.md                 # Project description and instructions
└── Documentation_Report.pdf  # Documentation of the project and report of the results
└── requirements.txt          # Python dependencies required to run the notebook
```

## 📊 Problem Statement
The goal is to predict the arrival delay (ArrDelay) of a domestic US flight using features available at take-off. This involves:

- Data analysis and cleaning
- Feature engineering
- Model training and validation
- Model serialization
- Model testing on unseen data using a Spark application

## 🔍 Data Source
Dataset: [Data Expo 2009 - Airline On-Time Performance](https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/HG7NV7)

- Training year: 1991 (1,000 rows)
- Testing year: 1989 (1,000 rows)

<ins>Note:</ins> To conserve computing resources, both the training and testing datasets were limited to 1,000 rows each, as all processing was performed locally on a personal computer.

## ❌ Forbidden Variables
Variables not allowed due to data leakage (known after take-off), e.g.:

ArrTime, ActualElapsedTime, AirTime, TaxiIn, Diverted, CarrierDelay, WeatherDelay, NASDelay, SecurityDelay, LateAircraftDelay

## 🎯 Target Variable
ArrDelay (Arrival Delay in minutes)

## 🧪 ML Pipeline Overview
- Notebook (project.ipynb):
  - Data loading and cleaning
  - Feature transformations (e.g. time parsing, distance categories)
  - Model training and evaluation (e.g. RMSE, R²)
  - Model export (best_model/)
- Spark Application (app.py):
  - Loads model and test dataset
  - Applies same transformations as training
  - Evaluates predictions using regression and business metrics
 
## 📈 Evaluation Metrics
- RMSE: Root Mean Squared Error
- MAE: Mean Absolute Error
- R² Score: Model goodness-of-fit
- 15-min Accuracy: % predictions within 15 minutes of actual delay
- Severe Delay Accuracy: Accuracy on delays > 60 minutes

## 🚀 Running the Application
Make sure Spark is installed and run the app as follows:
```
spark-submit --master local[*] app.py "[path_to_test_data]"
```

## 📦 Requirements
This project uses:
- Python 3.11.9
- Apache Spark (PySpark) 3.5.3
- Jupyter Notebook
